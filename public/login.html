<!doctype html>
<html lang="ko">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>로그인 / 회원가입</title>
	<style>
		body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:#f7fafc; color:#222; }
		.container { max-width:420px; margin:6vh auto; background:#fff; padding:24px; border-radius:8px; box-shadow:0 6px 18px rgba(0,0,0,0.06); }
		h1 { margin:0 0 18px 0; font-size:20px; }
		label { display:block; font-size:13px; margin:12px 0 6px; color:#444; }
		input[type="email"], input[type="password"] { width:100%; padding:10px 12px; border:1px solid #e2e8f0; border-radius:6px; font-size:14px; box-sizing:border-box; }
		.row { display:flex; gap:8px; margin-top:16px; }
		button { flex:1; padding:10px 12px; border-radius:6px; border:0; cursor:pointer; font-weight:600; }
		#loginBtn { background:#2563eb; color:#fff; }
		#signupBtn { background:#10b981; color:#fff; }
		#message { margin-top:14px; font-size:13px; color:#e11d48; min-height:18px; }
		.footer { margin-top:12px; font-size:13px; color:#6b7280; }
	</style>
</head>
<body>
	<div class="container">
		<h1>로그인</h1>
		<label for="email">이메일</label>
		<input id="email" type="email" placeholder="you@example.com" />

		<label for="password">비밀번호</label>
		<input id="password" type="password" placeholder="비밀번호를 입력하세요" />

		<div class="row">
			<button id="loginBtn">로그인</button>
			<button id="signupBtn">회원가입</button>
		</div>

		<div id="message" role="status" aria-live="polite"></div>
		<div class="footer">Supabase 인증 연동 예제 — 테스트 용도로만 사용하세요.</div>
	</div>

	<script type="module">
		import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

		// TODO: 배포 시 환경변수로 관리하세요. 현재는 예시용으로 하드코딩되어 있습니다.
		const SUPABASE_URL = 'https://vokdtihuzdbcgylftrar.supabase.co'
		const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZva2R0aWh1emRiY2d5bGZ0cmFyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgwMDQzMjUsImV4cCI6MjA4MzU4MDMyNX0.Vm9aw8AlUvV49AU1iMXyi1jPMGH8EgDS-9V8KEg5BTQ'

		const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)

		const emailInput = document.getElementById('email')
		const passwordInput = document.getElementById('password')
		const loginBtn = document.getElementById('loginBtn')
		const signupBtn = document.getElementById('signupBtn')
		const messageEl = document.getElementById('message')

		function showMessage(text, isError = true) {
			messageEl.style.color = isError ? '#e11d48' : '#065f46'
			messageEl.textContent = text
		}

		async function handleSignUp() {
			const email = emailInput.value.trim()
			const password = passwordInput.value
			if (!email || !password) {
				showMessage('이메일과 비밀번호를 모두 입력하세요.')
				return
			}
			showMessage('회원가입 중...', false)
			const { data, error } = await supabase.auth.signUp({ email, password })
			if (error) {
				showMessage(error.message || '회원가입 실패')
				return
			}
			showMessage('회원가입 요청이 전송되었습니다. 이메일을 확인해 주세요.', false)
			console.log('signUp data', data)
		}

		async function handleSignIn() {
			const email = emailInput.value.trim()
			const password = passwordInput.value
			if (!email || !password) {
				showMessage('이메일과 비밀번호를 모두 입력하세요.')
				return
			}
			showMessage('로그인 중...', false)
			const { data, error } = await supabase.auth.signInWithPassword({ email, password })
			if (error) {
				showMessage(error.message || '로그인 실패')
				return
			}
			showMessage('로그인 성공했습니다.', false)
			console.log('signIn data', data)
			// 로그인 성공 시 마이페이지로 이동
			location.href = '/mypage.html'
		}

		loginBtn.addEventListener('click', (e) => { e.preventDefault(); handleSignIn() })
		signupBtn.addEventListener('click', (e) => { e.preventDefault(); handleSignUp() })
	</script>
</body>
</html>


